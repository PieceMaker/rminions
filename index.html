<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>rminions</title>
        <meta name="description" content="A presentation showing how to run R tasks across multiple servers using Redis.">
        <meta name="author" content="Jonathan Adams">

        <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="node_modules/reveal.js/css/theme/black.css" id="theme">
        <link rel="stylesheet" href="css/main.css">
    </head>

    <body>
        <div class="reveal">
            <div class="slides">
                <!--Slide 1-->
                <section>
                    <h3>Grid Computing in R </h3>
                    <h4>with Redis Message Queues</h4>
                    <p>Jonathan Adams</p>
                    <p>useR! 2016</p>
                </section>

                <!--Slide 2-->
                <section>
                    <h3>Background</h3>
                    <!--Slide 2.1-->
                    <section>
                        <ul>
                            <li>
                                Common for me to run lots of jobs in R
                                <ul>
                                    <li>Fitting complex models</li>
                                    <li>Running simulations from a CAT model</li>
                                    <li>Numerical integration of posterior distributions</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <!--Slide 2.2-->
                    <section>
                        <ul>
                            <li>First used <code>snow</code> package.</li>
                            <li>
                                Worked as follows:
                                <ol>
                                    <li>Bundle code into function</li>
                                    <li>Create cluster of worker nodes</li>
                                    <li>Spread your jobs among the nodes before processing</li>
                                    <li>Wait for it to finish or throw an error</li>
                                </ol>
                            </li>
                        </ul>
                    </section>
                    <!--Slide 2.3-->
                    <section>
                        <ul>
                            <li>Pros</li>
                            <ul>
                                <li>Run multiple jobs simultaneously</li>
                                <li>Multiple methods of cluster creation</li>
                                <li>Could load-balance some clusters</li>
                            </ul>
                            <li>Cons</li>
                            <ul>
                                <li>Not all cluster could be load-balanced</li>
                                <li>Common to be waiting  for one or two nodes to finish</li>
                                <li>Poorly handled errors could cause loss of all work</li>
                                <li>Reproducing errors was complicated</li>
                                <li>Results not available until all processing finished</li>
                                <li>Could not increase size of cluster mid-processing</li>
                            </ul>
                        </ul>
                    </section>
                </section>

                <!--Slide 3-->
                <section>
                    <h3>Ways to Improve</h3>
                    <ul>
                        <li>Allow quick scaling up and down</li>
                        <li>Use any number of servers</li>
                        <li>Automatically load-balance</li>
                        <li>Access results as they are available</li>
                        <li>Separate errors for easy access and reproducibility</li>
                    </ul>
                </section>

                <!--Slide 4-->
                <section>
                    <h3>Redis</h3>
                    <ul>
                        <li>Redis is an in-memory NoSQL database</li>
                        <li>All objects are strings</li>
                        <li>
                            Allows clients to wait for messages to be available
                            <ul>
                                <li>Messages are queued and clients are first-come-first-served</li>
                                <li>Pop from and push to queues just like an array</li>
                            </ul>
                        </li>
                        <li>
                            Bindings made available in R through <code>rredis</code> package
                            <ul>
                                <li>Stores any R object by serializing</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <!--Slide 5-->
                <section>
                    <h3>Message Format</h3>
                    <ul>
                        <li>
                            Messages will be lists with the following keys:
                            <ul>
                                <li>Function - A function definition with one argument, <code>params</code></li>
                                <li>Parameters - A list of all parameters needed to execute the function</li>
                                <li>ResultsQueue - Name of the queue to store results in</li>
                                <li>ErrorQueue - Name of the queue to store errors in</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <!--Slide 6-->
                <section data-transition="fade-in">
                    <h3>Flowchart</h3>
                    <img src="./images/twoMinionsDiagram.png" height="550">
                </section>

                <!--Slide 7-->
                <section data-transition="fade-in">
                    <h3>Flowchart</h3>
                    <img src="./images/threeMinionsDiagram.png" height="550">
                </section>

                <!--Slide 8-->
                <section data-transition="fade-in">
                    <h3>Runtime</h3>
                    <img src="./images/runtimes.png" height = "550" width = "730">
                </section>

                <!--Slide 9-->
                <section>
                    <h3>Conclusion</h3>
                    <ul>
                        <li>This method satisfies listed improvements</li>
                        <li>Easily deployed in the cloud via Docker</li>
                        <li>Can communicate with all servers via PUB/SUB</li>
                        <li>Available on GitHub <a href="https://github.com/PieceMaker/rminions">https://github.com/PieceMaker/rminions</a></li>
                        <li>Similar package: <code>doRedis</code></li>
                    </ul>
                </section>
            </div>
        </div>
    </body>

    <script src="node_modules/reveal.js/lib/js/head.min.js"></script>
    <script src="node_modules/reveal.js/js/reveal.js"></script>
    <script src="node_modules/reveal.js/plugin/math/math.js"></script>

    <script>
        Reveal.initialize({
            src: "node_modules/reveal.js/plugin/math/math.js",
            async: true
        });
    </script>
</html>